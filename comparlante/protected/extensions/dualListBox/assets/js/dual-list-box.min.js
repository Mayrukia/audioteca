/**
 * jQuery DualListBox plugin v1.0
 * http://www.geodan.nl
 *
 * Copyright (c) 2014, Geodan B.V. (Alex van den Hoogen)
 * Update for Yii2: Makyutin Dmitriy http://www.maksyutin.ru
 * License: MIT License
 */
!function(t){function e(e,n){var i=!1;if(e.text.indexOf(":")>-1){var o=e.text.split(":");o.length>1&&(i=!0)}t.getJSON(e.uri,function(s){t.each(s,function(l,s){var a="";i?o.forEach(function(t){a+=s[t]+" "}):a=s[e.text],t("<option>",{value:s[e.value],text:a,selected:n.some(function(t){return t[e.value]===s[e.value]})===!0}).appendTo(e.element)}),l(e)})}function n(e){var n=t(e.parentElement+" .unselected"),l=t(e.parentElement+" .selected");t(e.parentElement).find("button").bind("click",function(){switch(t(this).data("type")){case"str":n.find("option:selected").appendTo(l),t(this).prop("disabled",!0);break;case"atr":(n.find("option").length>=e.maxAllBtn&&confirm(e.lngOptions.warning_info)||n.find("option").length<e.maxAllBtn)&&n.find("option").each(function(){t(this).isVisible()&&t(this).remove().appendTo(l)});break;case"stl":l.find("option:selected").remove().appendTo(n),t(this).prop("disabled",!0);break;case"atl":(l.find("option").length>=e.maxAllBtn&&confirm(e.lngOptions.warning_info)||l.find("option").length<e.maxAllBtn)&&l.find("option").each(function(){t(this).isVisible()&&t(this).remove().appendTo(n)})}n.filterByText(t(e.parentElement+" .filter-unselected"),e.timeout,e.parentElement).scrollTop(0).sortOptions(),l.filterByText(t(e.parentElement+" .filter-selected"),e.timeout,e.parentElement).scrollTop(0).sortOptions(),c(e)}),t(e.parentElement).closest("form").submit(function(){l.find("option").prop("selected",!0)}),t(e.parentElement).find('input[type="text"]').keypress(function(t){13===t.which&&event.preventDefault()}),l.filterByText(t(e.parentElement+" .filter-selected"),e.timeout,e.parentElement).scrollTop(0).sortOptions(),n.filterByText(t(e.parentElement+" .filter-unselected"),e.timeout,e.parentElement).scrollTop(0).sortOptions()}function l(t){o(t),p(t),n(t)}function i(e,n){var l=0,i=0,o=new Array;t(e+" .unselected").find("option").each(function(){t(this).isVisible()&&l++}),t(e+" .selected").find("option").each(function(){t(this).isVisible()&&(o[i]=this.value,i++)});var s=JSON.stringify(o);t("#"+n.name+"-"+n.id).val(s),t(e+" .unselected-count").text(l),t(e+" .selected-count").text(i),r(e)}function o(e){t(e.element).parent().attr("id",e.parent),t(e.parentElement).addClass("row").append((0==e.horizontal?'   <div class="col-md-5">':'   <div class="col-md-6">')+'       <h4><span class="unselected-title"></span> <small>'+e.lngOptions.showing+' <span class="unselected-count"></span></small></h4>       <input class="filter form-control filter-unselected" type="text" placeholder="'+e.lngOptions.search_placeholder+'" style="margin-bottom: 5px;">'+(0==e.horizontal?"":s(1,e.moveAllBtn))+'       <select class="unselected" style="height: 200px; width: 100%;" multiple></select>   </div>'+(0==e.horizontal?a(e.moveAllBtn):"")+(0==e.horizontal?'   <div class="col-md-5">':'   <div class="col-md-6">')+'       <h4><span class="selected-title"></span> <small>'+e.lngOptions.showing+' <span class="selected-count"></span></small></h4>       <input class="filter form-control filter-selected" type="text" placeholder="'+e.lngOptions.search_placeholder+'" style="margin-bottom: 5px;">'+(0==e.horizontal?"":s(2,e.moveAllBtn))+'       <select class="selected" style="height: 200px; width: 100%;" multiple></select>   </div>');t(e.parentElement+" .unselected"),t(e.parentElement+" .selected");t(e.parentElement+" .selected").prop("name",t(e.element).prop("name")),t(e.parentElement+" .unselected-title").text(e.lngOptions.available+" "+e.title),t(e.parentElement+" .selected-title").text(e.lngOptions.selected+" "+e.title)}function s(t,e){return 1==t?(e?'       <button type="button" class="btn btn-default atr" data-type="atr" style="margin-bottom: 5px;"><span class="glyphicon glyphicon-chevron-right"></span> <span class="glyphicon glyphicon-chevron-right"></span></button>':"")+'       <button type="button" class="btn btn-default '+(e?"pull-right col-md-6":"col-md-12")+' str" data-type="str" style="margin-bottom: 5px;" disabled><span class="glyphicon glyphicon-chevron-right"></span></button>':'       <button type="button" class="btn btn-default '+(e?"col-md-6":"col-md-12")+' stl" data-type="stl" style="margin-bottom: 5px;" disabled><span class="glyphicon glyphicon-chevron-left"></span></button>'+(e?'       <button type="button" class="btn btn-default col-md-6 pull-right atl" data-type="atl" style="margin-bottom: 5px;"><span class="glyphicon glyphicon-chevron-left"></span> <span class="glyphicon glyphicon-list"></span></button>':"")}function a(t){return'   <div class="col-md-2 center-block" style="margin-top: '+(t?"80px":"130px")+'">'+(t?'       <button type="button" class="btn btn-default col-md-8 col-md-offset-2 atr" data-type="atr" style="margin-bottom: 10px;"><span class="glyphicon glyphicon-chevron-right"></span> <span style="margin-left: -10px;" class="glyphicon glyphicon-chevron-right"></span></button>':"")+'       <button type="button" class="btn btn-default col-md-8 col-md-offset-2 str" data-type="str" style="margin-bottom: 20px;" disabled><span class="glyphicon glyphicon-chevron-right"></span></button>       <button type="button" class="btn btn-default col-md-8 col-md-offset-2 stl" data-type="stl" style="margin-bottom: 10px;" disabled><span class="glyphicon glyphicon-chevron-left"></span></button>'+(t?'       <button type="button" class="btn btn-default col-md-8 col-md-offset-2 atl" data-type="atl" style="margin-bottom: 10px;"><span class="glyphicon glyphicon-chevron-left"></span> <span style="margin-left: -10px;" class="glyphicon glyphicon-chevron-left"></span></button>':"")+"   </div>"}function c(e){t(e.parentElement+" .unselected").find("option:selected").prop("selected",!1),t(e.parentElement+" .selected").find("option:selected").prop("selected",!1),t(e.parentElement+" .filter").val(""),t(e.parentElement+" select").find("option").each(function(){t(this).show()}),i(e.parentElement,e)}function p(e){{var n=!1;t(e.parentElement+" .unselected"),t(e.parentElement+" .selected")}t(e.element).find("option").text(function(l,i){return t(this).data("title",i),i.length>e.textLength?(n=!0,i.substr(0,e.textLength)+"..."):void 0}).each(function(){n&&t(this).prop("title",t(this).data("title")),t(this).appendTo(t(this).is(":selected")?e.parentElement+" .selected":e.parentElement+" .unselected")}),t(e.element).remove(),c(e)}function r(e){t(e+" .unselected").change(function(){t(e+" .str").prop("disabled",!1)}),t(e+" .selected").change(function(){t(e+" .stl").prop("disabled",!1)}),0==t(e+" .unselected").has("option").length?(t(e+" .atr").prop("disabled",!0),t(e+" .str").prop("disabled",!0)):t(e+" .atr").prop("disabled",!1),0==t(e+" .selected").has("option").length?(t(e+" .atl").prop("disabled",!0),t(e+" .stl").prop("disabled",!0)):t(e+" .atl").prop("disabled",!1)}t.fn.DualListBox=function(n,i){return this.each(function(){var o={element:t(this).context,id:t(this).context.id,name:t(this).context.id,uri:"local.json",value:"id",text:"name",title:"Example",json:!0,timeout:500,horizontal:!1,textLength:45,moveAllBtn:!0,maxAllBtn:1e3,lngOptions:{warning_info:"Are you sure you want to move this many items? Doing so can cause your browser to become unresponsive.",search_placeholder:"Filter",showing:"- showing",available:"Available",selected:"Selected"}},s={element:t(this).context,id:t(this).data("id"),name:t(this).data("name"),uri:t(this).data("source"),value:t(this).data("value"),text:t(this).data("text"),title:t(this).data("title"),json:t(this).data("json"),timeout:t(this).data("timeout"),horizontal:t(this).data("horizontal"),textLength:t(this).data("textLength"),moveAllBtn:t(this).data("moveAllBtn"),maxAllBtn:t(this).data("maxAllBtn")},a=t.extend({},o,s,n),c=a.id.id;t.each(a,function(t,e){if(void 0===e||null===e)throw"DualListBox: "+t+" is undefined."}),a.id=c,a.parent="dlb-"+c,a.parentElement="#"+a.parent,i=t.extend([{}],i),a.json?e(a,i):l(a)})},t.fn.filterByText=function(e,n,l){return this.each(function(){var o=this,s=[];t(o).find("option").each(function(){s.push({value:t(this).val(),text:t(this).text()})}),t(o).data("options",s),t(e).bind("change keyup",function(){d(function(){var n=t(o).data("options"),s=t.trim(t(e).val()),a=new RegExp(s,"gi");t.each(n,function(e){null===n[e].text.match(a)?t(o).find(t('option[value="'+n[e].value+'"]')).hide():t(o).find(t('option[value="'+n[e].value+'"]')).show()}),i(l,n)},n)})})},t.fn.isVisible=function(){return!("hidden"==t(this).css("visibility")||"none"==t(this).css("display"))},t.fn.sortOptions=function(){return this.each(function(){t(this).append(t(this).find("option").remove().sort(function(e,n){var l=t(e).text(),i=t(n).text();return l>i?1:i>l?-1:0}))})};var d=function(){var t=0;return function(e,n){clearTimeout(t),t=setTimeout(e,n)}}()}(jQuery);